<RunSynchronousCommand wcm:action="add">
  <Order>106</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo mkdir -Path "C:\Windows\Setup\Scripts" -ErrorAction 'SilentlyContinue';"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>107</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo $doc = [xml]::new(); $doc.Load( "C:\Windows\Panther\unattend.xml" );"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>108</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo foreach( $file in $doc.unattend.Extensions.File ) {"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>109</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo $path = $file.GetAttribute( 'path' );"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>110</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo $encoding = switch( [System.IO.Path]::GetExtension( $path ) ) {"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>111</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo '.ps1' { [System.Text.Encoding]::UTF8; }"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>112</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo '.cmd' { [System.Text.Encoding]::Default; }"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>113</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo { $_ -in '.reg', '.vbs', '.js' } { [System.Text.UnicodeEncoding]::new( $false, $true ); }"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>114</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo };"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>115</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo [System.IO.File]::WriteAllBytes( $path, ( $encoding.GetPreamble() + $encoding.GetBytes( $file.InnerText ) ) );"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>116</Order>
  <Path>cmd.exe /c ">>"C:\Windows\Temp\ExtractScripts.ps1" echo }"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>117</Order>
  <Path>powershell.exe -NoProfile -Command "Get-Content -LiteralPath 'C:\Windows\Temp\ExtractScripts.ps1' -Raw | Invoke-Expression;"</Path>
</RunSynchronousCommand>
<RunSynchronousCommand wcm:action="add">
  <Order>118</Order>
  <Path>reg.exe add "HKU\mount\Software\Microsoft\Windows\CurrentVersion\Runonce" /v "unattend-01" /t REG_SZ /d "powershell.exe -NoProfile -Command \"Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\unattend-01.ps1' -Raw | Invoke-Expression;\"" /f</Path>
</RunSynchronousCommand>